<!doctypehtml><html lang=zh-CN><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>成绩展示</title><style>:root{--bg:#f7f9fb;--card:#ffffff;--text:#222;--muted:#666;--accent:#2563eb;--danger:#c0392b;--ok:#16a085;--border:#e5e7eb}body,html{height:100%}body{margin:0;background:var(--bg);color:var(--text);font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,'PingFang SC','Microsoft YaHei',sans-serif}.container{max-width:1200px;margin:24px auto;padding:0 16px}.card{background:var(--card);border:1px solid var(--border);border-radius:12px;box-shadow:0 6px 24px rgba(0,0,0,.06);padding:16px;margin-bottom:16px;min-width:1000px}.header{display:flex;flex-wrap:wrap;gap:12px 24px;align-items:center}.field{display:flex;align-items:center;gap:8px}label{font-weight:600}.mode-switch,select{padding:8px 10px;border:1px solid var(--border);border-radius:8px;background:#fff}.mode-switch{display:flex;align-items:center;gap:8px}.note{color:var(--muted);font-size:13px}.table-wrap{overflow:auto}table{width:100%;border-collapse:collapse;min-width:900px}thead th{position:sticky;top:0;background:#f2f4f8;border-bottom:1px solid var(--border);padding:10px;text-align:left;font-size:14px;white-space:nowrap;cursor:pointer;user-select:none}tbody td{border-bottom:1px solid var(--border);padding:10px;font-size:14px}tbody tr:hover{background:#fafafa}.sort-ind{color:var(--accent);margin-left:6px;font-size:12px}.invalid{color:var(--danger);font-weight:600}tbody tr.row-highlight{background:#fff7e6}tbody tr.row-highlight td{font-weight:600}.status{display:flex;align-items:center;gap:8px;flex-wrap:wrap;margin-top:8px;color:var(--muted);font-size:13px}.status .badge{background:#eef2ff;color:var(--accent);padding:4px 8px;border-radius:999px}.status .warn{background:#fdecea;color:var(--danger)}.charts-row{display:flex;gap:16px;align-items:stretch}.chart-box{flex:1}.chart-box.chart-scores{flex:2}.chart-box.chart-summary{flex:1}#chartScores,#chartSummary{width:100%;height:420px}@media (max-width:720px){#chartScores,#chartSummary{height:320px}}</style></head><body><div class=container><div class=card><div class=header><div class=field><label for=nameSelect>学生：</label> <select id=nameSelect style=width:120px></select></div><div class=field><label for=examSelect>考试：</label> <select id=examSelect style=width:120px></select> <button id=rotateBtn class=action-btn>旋转屏幕</button></div></div><div class=status id=statusBar></div></div><div class="card charts-row"><div class="chart-box chart-scores"><div id=chartScores></div></div><div class="chart-box chart-summary"><div id=chartSummary></div></div></div><div class="card table-wrap"><table id=scoreTable><thead><tr id=tableHeaderRow></tr></thead><tbody id=tableBody></tbody></table></div></div><script>const styleExtra=document.createElement("style");styleExtra.textContent="button.action-btn{padding:8px 10px;border:1px solid var(--border);border-radius:8px;background:#fff;cursor:pointer}button.action-btn:active{transform:scale(.98)}html.landscape-mode body{position:relative;top:0;left:0;width:100vh;min-height:100vw;transform:rotate(90deg) translateY(-100vh);transform-origin:top left;overflow:auto}",document.head.appendChild(styleExtra);const DATA_BASE=[{"序号":"251001","姓名":"白书凡","考试":"10月考","语文":121,"数学":76,"英语":131.5,"物理":64,"化学":75,"生物":89,"政治":89,"历史":75,"地理":70,"总分年排":179},{"序号":"251002","姓名":"曹坤","考试":"10月考","语文":110,"数学":101,"英语":117.5,"物理":59,"化学":92,"生物":95,"政治":88,"历史":68,"地理":84,"总分年排":93},{"序号":"251003","姓名":"曾芮","考试":"10月考","语文":114,"数学":97,"英语":111.5,"物理":69,"化学":83,"生物":84,"政治":87,"历史":82,"地理":82,"总分年排":110},{"序号":"251004","姓名":"陈浩天","考试":"10月考","语文":113,"数学":107,"英语":119,"物理":92,"化学":74,"生物":81,"政治":67,"历史":69,"地理":70,"总分年排":170},{"序号":"251005","姓名":"陈誉锋","考试":"10月考","语文":103,"数学":100,"英语":128,"物理":83,"化学":94,"生物":87,"政治":65,"历史":58,"地理":88,"总分年排":125},{"序号":"251006","姓名":"陈兆奕","考试":"10月考","语文":110,"数学":100,"英语":111.5,"物理":64,"化学":77,"生物":76,"政治":82,"历史":62,"地理":80,"总分年排":304},{"序号":"251007","姓名":"单闫","考试":"10月考","语文":107,"数学":76,"英语":104,"物理":64,"化学":87,"生物":83,"政治":86,"历史":73,"地理":82,"总分年排":305},{"序号":"251008","姓名":"邓鑫","考试":"10月考","语文":104,"数学":107,"英语":121,"物理":74,"化学":78,"生物":79,"政治":80,"历史":67,"地理":76,"总分年排":199},{"序号":"251009","姓名":"冯梓媛","考试":"10月考","语文":101,"数学":77,"英语":130,"物理":70,"化学":74,"生物":72,"政治":71,"历史":68,"地理":56,"总分年排":539},{"序号":"251010","姓名":"何沛东","考试":"10月考","语文":105,"数学":0,"英语":0,"物理":0,"化学":81,"生物":78,"政治":0,"历史":0,"地理":0,"总分年排":937},{"序号":"251011","姓名":"胡欣怡","考试":"10月考","语文":106,"数学":88,"英语":113,"物理":76,"化学":77,"生物":82,"政治":78,"历史":62,"地理":64,"总分年排":404},{"序号":"251012","姓名":"黄伟诚","考试":"10月考","语文":94,"数学":0,"英语":118,"物理":0,"化学":77,"生物":75,"政治":0,"历史":0,"地理":0,"总分年排":932},{"序号":"251013","姓名":"黄心语","考试":"10月考","语文":109,"数学":113,"英语":114,"物理":74,"化学":85,"生物":87,"政治":88,"历史":65,"地理":80,"总分年排":91},{"序号":"251014","姓名":"贾美莎","考试":"10月考","语文":115,"数学":118,"英语":115,"物理":94,"化学":90,"生物":95,"政治":86,"历史":68,"地理":84,"总分年排":16},{"序号":"251015","姓名":"姜人文","考试":"10月考","语文":107,"数学":120,"英语":127,"物理":87,"化学":95,"生物":80,"政治":61,"历史":58,"地理":78,"总分年排":95},{"序号":"251016","姓名":"黎思彤","考试":"10月考","语文":106,"数学":97,"英语":112.5,"物理":80,"化学":71,"生物":85,"政治":88,"历史":69,"地理":80,"总分年排":189},{"序号":"251017","姓名":"李好好","考试":"10月考","语文":104,"数学":99,"英语":126.5,"物理":79,"化学":74,"生物":92,"政治":85,"历史":78,"地理":86,"总分年排":69},{"序号":"251018","姓名":"梁家钰","考试":"10月考","语文":114,"数学":89,"英语":109.5,"物理":59,"化学":88,"生物":85,"政治":88,"历史":83,"地理":82,"总分年排":152},{"序号":"251019","姓名":"刘馨雨","考试":"10月考","语文":115,"数学":91,"英语":116.5,"物理":74,"化学":74,"生物":93,"政治":88,"历史":66,"地理":78,"总分年排":158},{"序号":"251020","姓名":"刘雨桐","考试":"10月考","语文":110,"数学":115,"英语":125,"物理":82,"化学":92,"生物":89,"政治":63,"历史":76,"地理":80,"总分年排":52},{"序号":"251021","姓名":"龙奕瑾","考试":"10月考","语文":97,"数学":50,"英语":98.5,"物理":51,"化学":51,"生物":70,"政治":73,"历史":71,"地理":52,"总分年排":869},{"序号":"251022","姓名":"卢怡","考试":"10月考","语文":93,"数学":90,"英语":107,"物理":63,"化学":67,"生物":71,"政治":69,"历史":70,"地理":70,"总分年排":614},{"序号":"251023","姓名":"毛新瑞","考试":"10月考","语文":100,"数学":110,"英语":118.5,"物理":89,"化学":96,"生物":84,"政治":79,"历史":78,"地理":82,"总分年排":44},{"序号":"251024","姓名":"聂铭轩","考试":"10月考","语文":112,"数学":86,"英语":110,"物理":83,"化学":74,"生物":85,"政治":80,"历史":75,"地理":78,"总分年排":210},{"序号":"251025","姓名":"欧雨嘉","考试":"10月考","语文":89,"数学":67,"英语":122,"物理":71,"化学":76,"生物":64,"政治":42,"历史":55,"地理":66,"总分年排":788},{"序号":"251026","姓名":"彭琪雯","考试":"10月考","语文":109,"数学":80,"英语":133,"物理":71,"化学":77,"生物":86,"政治":80,"历史":65,"地理":78,"总分年排":227},{"序号":"251027","姓名":"钱虹羽","考试":"10月考","语文":117,"数学":69,"英语":119.5,"物理":72,"化学":77,"生物":90,"政治":83,"历史":68,"地理":82,"总分年排":232},{"序号":"251028","姓名":"钱思雨","考试":"10月考","语文":115,"数学":113,"英语":122,"物理":87,"化学":94,"生物":94,"政治":74,"历史":66,"地理":66,"总分年排":55},{"序号":"251029","姓名":"沈新雅","考试":"10月考","语文":112,"数学":61,"英语":128,"物理":68,"化学":75,"生物":88,"政治":67,"历史":64,"地理":84,"总分年排":395},{"序号":"251030","姓名":"孙若菡","考试":"10月考","语文":101,"数学":89,"英语":117.5,"物理":69,"化学":82,"生物":70,"政治":77,"历史":67,"地理":48,"总分年排":532},{"序号":"251031","姓名":"王传盟","考试":"10月考","语文":97,"数学":89,"英语":91.5,"物理":70,"化学":42,"生物":64,"政治":61,"历史":62,"地理":68,"总分年排":805},{"序号":"251032","姓名":"王牧天","考试":"10月考","语文":71,"数学":67,"英语":107,"物理":72,"化学":62,"生物":69,"政治":77,"历史":67,"地理":80,"总分年排":734},{"序号":"251033","姓名":"王棋灏","考试":"10月考","语文":99,"数学":107,"英语":104,"物理":67,"化学":92,"生物":88,"政治":64,"历史":57,"地理":74,"总分年排":364},{"序号":"251034","姓名":"吴海涛","考试":"10月考","语文":96,"数学":67,"英语":130.5,"物理":80,"化学":83,"生物":87,"政治":86,"历史":74,"地理":84,"总分年排":196},{"序号":"251035","姓名":"向芷颖","考试":"10月考","语文":101,"数学":64,"英语":120,"物理":62,"化学":67,"生物":85,"政治":84,"历史":64,"地理":69,"总分年排":554},{"序号":"251036","姓名":"严思毅","考试":"10月考","语文":106,"数学":132,"英语":131,"物理":72,"化学":86,"生物":81,"政治":94,"历史":84,"地理":86,"总分年排":8},{"序号":"251037","姓名":"杨上淦","考试":"10月考","语文":95,"数学":88,"英语":102,"物理":62,"化学":70,"生物":82,"政治":75,"历史":73,"地理":80,"总分年排":498},{"序号":"251038","姓名":"张欣彤","考试":"10月考","语文":104,"数学":64,"英语":118.5,"物理":59,"化学":77,"生物":83,"政治":81,"历史":70,"地理":79,"总分年排":458},{"序号":"251039","姓名":"张雪瑶","考试":"10月考","语文":105,"数学":84,"英语":128,"物理":78,"化学":79,"生物":76,"政治":88,"历史":56,"地理":70,"总分年排":297},{"序号":"251040","姓名":"赵雨轩","考试":"10月考","语文":102,"数学":131,"英语":126.5,"物理":87,"化学":85,"生物":97,"政治":75,"历史":75,"地理":85,"总分年排":17},{"序号":"251041","姓名":"郑桔","考试":"10月考","语文":110,"数学":115,"英语":126,"物理":74,"化学":75,"生物":87,"政治":73,"历史":68,"地理":74,"总分年排":140},{"序号":"251042","姓名":"周国宏","考试":"10月考","语文":106,"数学":95,"英语":127,"物理":82,"化学":48,"生物":72,"政治":57,"历史":61,"地理":62,"总分年排":578},{"序号":"251043","姓名":"邹梓晗","考试":"10月考","语文":108,"数学":64,"英语":112.5,"物理":50,"化学":65,"生物":72,"政治":62,"历史":79,"地理":72,"总分年排":680},{"序号":"251101","姓名":"白书凡","考试":"期中考","语文":105,"数学":112,"英语":127.5,"物理":71,"化学":75,"生物":84,"政治":77,"历史":77,"地理":66,"总分年排":109},{"序号":"251102","姓名":"曹坤","考试":"期中考","语文":97,"数学":114,"英语":118,"物理":70,"化学":88,"生物":93,"政治":77,"历史":83,"地理":79,"总分年排":46},{"序号":"251103","姓名":"曾芮","考试":"期中考","语文":109,"数学":127,"英语":111.5,"物理":77,"化学":82,"生物":90,"政治":72,"历史":82,"地理":78,"总分年排":29},{"序号":"251104","姓名":"陈浩天","考试":"期中考","语文":113,"数学":99,"英语":122.5,"物理":47,"化学":72,"生物":59,"政治":59,"历史":88,"地理":63,"总分年排":436},{"序号":"251105","姓名":"陈誉锋","考试":"期中考","语文":99,"数学":111,"英语":116,"物理":57,"化学":79,"生物":93,"政治":70,"历史":78,"地理":85,"总分年排":131},{"序号":"251106","姓名":"陈兆奕","考试":"期中考","语文":105,"数学":114,"英语":110,"物理":44,"化学":59,"生物":60,"政治":78,"历史":68,"地理":63,"总分年排":554},{"序号":"251107","姓名":"单闫","考试":"期中考","语文":82,"数学":89,"英语":109.5,"物理":65,"化学":78,"生物":82,"政治":61,"历史":78,"地理":70,"总分年排":480},{"序号":"251108","姓名":"邓鑫","考试":"期中考","语文":96,"数学":99,"英语":121,"物理":84,"化学":78,"生物":80,"政治":77,"历史":83,"地理":80,"总分年排":95},{"序号":"251109","姓名":"冯梓媛","考试":"期中考","语文":105,"数学":108,"英语":135,"物理":44,"化学":77,"生物":51,"政治":65,"历史":75,"地理":56,"总分年排":470},{"序号":"251110","姓名":"何沛东","考试":"期中考","语文":104,"数学":102,"英语":125.5,"物理":61,"化学":77,"生物":86,"政治":55,"历史":75,"地理":64,"总分年排":303},{"序号":"251111","姓名":"胡欣怡","考试":"期中考","语文":94,"数学":86,"英语":125.5,"物理":56,"化学":68,"生物":76,"政治":66,"历史":61,"地理":53,"总分年排":623},{"序号":"251112","姓名":"黄伟诚","考试":"期中考","语文":110,"数学":106,"英语":113,"物理":62,"化学":80,"生物":85,"政治":64,"历史":76,"地理":61,"总分年排":269},{"序号":"251113","姓名":"黄心语","考试":"期中考","语文":106,"数学":114,"英语":134,"物理":68,"化学":81,"生物":78,"政治":72,"历史":71,"地理":66,"总分年排":124},{"序号":"251114","姓名":"贾美莎","考试":"期中考","语文":102,"数学":111,"英语":127,"物理":79,"化学":84,"生物":93,"政治":73,"历史":77,"地理":82,"总分年排":31},{"序号":"251115","姓名":"姜人文","考试":"期中考","语文":97,"数学":114,"英语":113,"物理":74,"化学":87,"生物":82,"政治":56,"历史":89,"地理":65,"总分年排":177},{"序号":"251116","姓名":"黎思彤","考试":"期中考","语文":108,"数学":100,"英语":109.5,"物理":50,"化学":70,"生物":73,"政治":72,"历史":83,"地理":76,"总分年排":345},{"序号":"251117","姓名":"李好好","考试":"期中考","语文":106,"数学":104,"英语":125.5,"物理":57,"化学":74,"生物":85,"政治":59,"历史":80,"地理":77,"总分年排":223},{"序号":"251118","姓名":"梁家钰","考试":"期中考","语文":110,"数学":124,"英语":101,"物理":69,"化学":84,"生物":92,"政治":74,"历史":88,"地理":82,"总分年排":36},{"序号":"251119","姓名":"刘馨雨","考试":"期中考","语文":95,"数学":121,"英语":126.5,"物理":74,"化学":61,"生物":84,"政治":72,"历史":79,"地理":60,"总分年排":200},{"序号":"251120","姓名":"刘雨桐","考试":"期中考","语文":109,"数学":106,"英语":99.5,"物理":71,"化学":77,"生物":67,"政治":67,"历史":64,"地理":68,"总分年排":411},{"序号":"251121","姓名":"龙奕瑾","考试":"期中考","语文":103,"数学":89,"英语":77.5,"物理":52,"化学":68,"生物":54,"政治":50,"历史":69,"地理":54,"总分年排":848},{"序号":"251122","姓名":"卢怡","考试":"期中考","语文":100,"数学":82,"英语":95.5,"物理":31,"化学":71,"生物":83,"政治":66,"历史":60,"地理":71,"总分年排":727},{"序号":"251123","姓名":"毛新瑞","考试":"期中考","语文":107,"数学":112,"英语":118.5,"物理":73,"化学":95,"生物":78,"政治":85,"历史":81,"地理":67,"总分年排":52},{"序号":"251124","姓名":"聂铭轩","考试":"期中考","语文":102,"数学":126,"英语":124,"物理":59,"化学":77,"生物":72,"政治":75,"历史":67,"地理":73,"总分年排":190},{"序号":"251125","姓名":"欧雨嘉","考试":"期中考","语文":106,"数学":100,"英语":116.5,"物理":59,"化学":46,"生物":55,"政治":64,"历史":52,"地理":61,"总分年排":727},{"序号":"251126","姓名":"彭琪雯","考试":"期中考","语文":116,"数学":110,"英语":139,"物理":52,"化学":87,"生物":84,"政治":63,"历史":77,"地理":65,"总分年排":113},{"序号":"251127","姓名":"钱虹羽","考试":"期中考","语文":103,"数学":113,"英语":129,"物理":54,"化学":81,"生物":83,"政治":83,"历史":77,"地理":81,"总分年排":82},{"序号":"251128","姓名":"钱思雨","考试":"期中考","语文":109,"数学":108,"英语":122.5,"物理":73,"化学":83,"生物":83,"政治":61,"历史":59,"地理":59,"总分年排":267},{"序号":"251129","姓名":"沈新雅","考试":"期中考","语文":106,"数学":111,"英语":129.5,"物理":56,"化学":83,"生物":73,"政治":62,"历史":81,"地理":65,"总分年排":225},{"序号":"251130","姓名":"孙若菡","考试":"期中考","语文":118,"数学":106,"英语":129,"物理":48,"化学":83,"生物":75,"政治":65,"历史":65,"地理":55,"总分年排":332},{"序号":"251131","姓名":"王传盟","考试":"期中考","语文":96,"数学":105,"英语":110.5,"物理":51,"化学":59,"生物":69,"政治":60,"历史":65,"地理":60,"总分年排":666},{"序号":"251132","姓名":"王牧天","考试":"期中考","语文":93,"数学":111,"英语":117,"物理":50,"化学":71,"生物":82,"政治":73,"历史":80,"地理":65,"总分年排":341},{"序号":"251133","姓名":"王棋灏","考试":"期中考","语文":103,"数学":96,"英语":97.5,"物理":71,"化学":76,"生物":80,"政治":64,"历史":67,"地理":65,"总分年排":452},{"序号":"251134","姓名":"吴海涛","考试":"期中考","语文":100,"数学":112,"英语":122.5,"物理":73,"化学":80,"生物":89,"政治":70,"历史":70,"地理":79,"总分年排":105},{"序号":"251135","姓名":"向芷颖","考试":"期中考","语文":106,"数学":82,"英语":129,"物理":58,"化学":63,"生物":80,"政治":60,"历史":71,"地理":53,"总分年排":546},{"序号":"251136","姓名":"严思毅","考试":"期中考","语文":108,"数学":113,"英语":135.5,"物理":72,"化学":85,"生物":77,"政治":63,"历史":87,"地理":76,"总分年排":52},{"序号":"251137","姓名":"杨上淦","考试":"期中考","语文":114,"数学":104,"英语":100,"物理":59,"化学":63,"生物":73,"政治":67,"历史":72,"地理":67,"总分年排":455},{"序号":"251138","姓名":"张欣彤","考试":"期中考","语文":97,"数学":88,"英语":110,"物理":61,"化学":67,"生物":71,"政治":62,"历史":65,"地理":63,"总分年排":632},{"序号":"251139","姓名":"张雪瑶","考试":"期中考","语文":102,"数学":119,"英语":128,"物理":64,"化学":67,"生物":85,"政治":58,"历史":49,"地理":64,"总分年排":370},{"序号":"251140","姓名":"赵雨轩","考试":"期中考","语文":94,"数学":122,"英语":129,"物理":83,"化学":83,"生物":86,"政治":66,"历史":71,"地理":66,"总分年排":92},{"序号":"251141","姓名":"郑桔","考试":"期中考","语文":102,"数学":116,"英语":120,"物理":59,"化学":86,"生物":85,"政治":60,"历史":87,"地理":78,"总分年排":113},{"序号":"251142","姓名":"周国宏","考试":"期中考","语文":102,"数学":120,"英语":126,"物理":63,"化学":58,"生物":52,"政治":57,"历史":60,"地理":58,"总分年排":577},{"序号":"251143","姓名":"邹梓晗","考试":"期中考","语文":107,"数学":90,"英语":118,"物理":51,"化学":60,"生物":65,"政治":69,"历史":79,"地理":68,"总分年排":516}],KEY_EXAM="考试",KEY_NAME="姓名",KEY_TOTAL="总分",KEY_SCI_TOTAL="理科总分",KEY_TOTAL_CLASS_RANK="总分班排",KEY_SCI_CLASS_RANK="理科班排",KEY_TOTAL_YEAR_RANK="总分年排",DEFAULT_NAME="姜人文",NS_SVG="http://www.w3.org/2000/svg",TICK_SCORE_STEP_SUBJECTS=25,TICK_SCORE_STEP_SUMMARY=150,TICK_RANK_STEP=5,SCORE_HIGHLIGHT_RATIO=.8,COLOR_SCORE_HIGHLIGHT="#FF3333",FULL_MARKS={"语文":150,"数学":150,"英语":150,"物理":100,"化学":100,"生物":100,"政治":100,"历史":100,"地理":100,[KEY_TOTAL]:1050,[KEY_SCI_TOTAL]:750},TABLE_COLUMNS=["序号","姓名","考试","语文","数学","英语","物理","化学","生物","政治","历史","地理","总分","总分班排","总分年排","理科总分","理科班排"],SUBJECTS=["语文","数学","英语","物理","化学","生物","政治","历史","地理"];let records=[],byNameExam={},namesOrder=[],examsOrder=[];function precomputeDataBaseTotals(){for(const t of DATA_BASE){const e=(t["语文"]||0)+(t["数学"]||0)+(t["英语"]||0)+(t["物理"]||0)+(t["化学"]||0)+(t["生物"]||0)+(t["政治"]||0)+(t["历史"]||0)+(t["地理"]||0),n=(t["语文"]||0)+(t["数学"]||0)+(t["英语"]||0)+(t["物理"]||0)+(t["化学"]||0)+(t["生物"]||0);t["总分"]=e,t["理科总分"]=n}}function buildData(){records=DATA_BASE.map(t=>({...t})),namesOrder=[],examsOrder=[];for(const t of records)namesOrder.includes(t["姓名"])||namesOrder.push(t["姓名"]),examsOrder.includes(t["考试"])||examsOrder.push(t["考试"]);byNameExam=buildIndex(records)}function computeClassRanks(t){const e=new Map;for(const n of t){const t=n["考试"];e.has(t)||e.set(t,[]),e.get(t).push(n)}for(const[t,n]of e.entries()){[...n].sort((t,e)=>e["总分"]!==t["总分"]?e["总分"]-t["总分"]:t["姓名"].localeCompare(e["姓名"],"zh-Hans")).forEach((t,e)=>{t["总分班排"]=e+1});[...n].sort((t,e)=>e["理科总分"]!==t["理科总分"]?e["理科总分"]-t["理科总分"]:t["姓名"].localeCompare(e["姓名"],"zh-Hans")).forEach((t,e)=>{t["理科班排"]=e+1})}}function buildIndex(t){const e={};for(const n of t){const t=n["姓名"],r=n["考试"];e[t]||(e[t]={}),e[t][r]=n}return e}function fillSelectOptions(){const t=document.getElementById("nameSelect"),e=document.getElementById("examSelect");t.innerHTML=namesOrder.map(t=>`<option value="${t}">${t}</option>`).join(""),e.innerHTML=examsOrder.map(t=>`<option value="${t}">${t}</option>`).join(""),namesOrder.length&&(t.value=namesOrder.includes("姜人文")?"姜人文":namesOrder[0]),examsOrder.length&&(e.value=examsOrder[0])}const sortState={key:"总分班排",order:"asc"};function renderTable(){const t=document.getElementById("nameSelect").value,e=document.getElementById("examSelect").value,n=document.getElementById("tableHeaderRow"),r=document.getElementById("tableBody");n.innerHTML=TABLE_COLUMNS.map(t=>{const e=sortState.key===t?"asc"===sortState.order?"▲":"▼":"";return`<th data-key="${t}">${t}${e?`<span class='sort-ind'>${e}</span>`:""}</th>`}).join(""),n.querySelectorAll("th").forEach(t=>{t.addEventListener("click",()=>{const e=t.getAttribute("data-key");sortState.key===e?sortState.order="asc"===sortState.order?"desc":"asc":(sortState.key=e,sortState.order="asc"),renderTable()})});let o=records.filter(t=>t["考试"]===e);const a=sortState.key,s=sortState.order;"序号"===a?"desc"===s&&o.reverse():o.sort((t,e)=>{const n=t[a],r=e[a];let o;return o="number"==typeof n&&"number"==typeof r?n-r:String(n).localeCompare(String(r),"zh-Hans"),"asc"===s?o:-o});const i=document.createDocumentFragment();if(0===o.length){const t=document.createElement("tr"),e=document.createElement("td");e.setAttribute("colspan",String(TABLE_COLUMNS.length)),e.textContent="当前筛选无数据",t.appendChild(e),i.appendChild(t)}else for(let e=0;e<o.length;e++){const n=o[e],r=document.createElement("tr");n["姓名"]===t&&(r.className="row-highlight");for(const t of TABLE_COLUMNS){const o=document.createElement("td");if("序号"===t)o.textContent=String(e+1);else{const e=n[t];o.textContent=null!=e?String(e):""}r.appendChild(o)}i.appendChild(r)}r.replaceChildren(i)}const COLOR_PALETTE=["#2563eb","#f59e0b","#16a085","#c0392b","#8e44ad","#2ecc71","#e67e22","#1abc9c"];function drawGroupedBarChart(t,e,n,r,o,a=COLOR_PALETTE,s="chartScores",i=null,c=null){const d=document.getElementById(s);if(!d)return;d.innerHTML="";const l=d.clientWidth||800,m=d.clientHeight||420;let u={top:90,right:20,bottom:60,left:50};"chartSummary"===s&&(u.right=30);const S=Math.max(100,l-u.left-u.right),h=Math.max(100,m-u.top-u.bottom),b=o.map(t=>"score"===t),g=o.map(t=>"rank"===t),p="chartScores"===s;const A=e.map((t,e)=>{return b[e]?"语文"===(n=t)||"数学"===n||"英语"===n?150:"总分"===n?1050:"理科总分"===n?750:100:0;var n}),E=Math.max(1,...A),f=Math.max(1,...n.flatMap(t=>t.filter((t,e)=>g[e])).map(t=>Number.isFinite(t)?t:0)),x=S/e.length,C=Math.max(24,.8*x),y=n.length,_=Math.min(6,Math.max(2,Math.floor(.06*C))),N=Math.max(10,Math.floor((C-_*(y-1))/y)),T=document.createElementNS(NS_SVG,"svg");T.setAttribute("width",String(l)),T.setAttribute("height",String(m));const M=document.createElementNS(NS_SVG,"text");M.setAttribute("x",String(l/2)),M.setAttribute("y",String(u.top/2)),M.setAttribute("text-anchor","middle"),M.setAttribute("font-size","14"),M.setAttribute("fill","#222"),M.textContent=t,T.appendChild(M);const O=document.createElementNS(NS_SVG,"g"),L=document.createElementNS(NS_SVG,"line");L.setAttribute("x1",String(u.left)),L.setAttribute("y1",String(m-u.bottom)),L.setAttribute("x2",String(l-u.right)),L.setAttribute("y2",String(m-u.bottom)),L.setAttribute("stroke","#bbb"),O.appendChild(L);const B=document.createElementNS(NS_SVG,"line");B.setAttribute("x1",String(u.left)),B.setAttribute("y1",String(u.top)),B.setAttribute("x2",String(u.left)),B.setAttribute("y2",String(m-u.bottom)),B.setAttribute("stroke","#bbb"),O.appendChild(B),T.appendChild(O);const G=document.createElementNS(NS_SVG,"g"),I="chartSummary"===s;{const t=E,e=I?i??150:i??Math.max(10,10*Math.round(t/5/10));for(let n=0;n<=t;n+=e){const e=Math.round(m-u.bottom-n/t*h),r=document.createElementNS(NS_SVG,"line");r.setAttribute("x1",String(u.left)),r.setAttribute("y1",String(e)),r.setAttribute("x2",String(l-u.right)),r.setAttribute("y2",String(e)),r.setAttribute("stroke","#eeeeee"),G.appendChild(r);const o=document.createElementNS(NS_SVG,"text");o.setAttribute("x",String(u.left-10)),o.setAttribute("y",String(e+4)),o.setAttribute("text-anchor","end"),o.setAttribute("font-size","10"),o.setAttribute("fill","#888"),o.textContent=String(n),G.appendChild(o)}}if(I&&g.some(Boolean)){const t=c&&c.length?Math.max(...c):f,e=5;for(let n=0;n<=t;n+=e){const e=Math.round(m-u.bottom-n/t*h),r=document.createElementNS(NS_SVG,"text");r.setAttribute("x",String(l-u.right+10)),r.setAttribute("y",String(e+4)),r.setAttribute("text-anchor","start"),r.setAttribute("font-size","10"),r.setAttribute("fill","#888"),r.textContent=String(n),G.appendChild(r)}}T.appendChild(G);const v=document.createElementNS(NS_SVG,"g");for(let t=0;t<e.length;t++){const r=Math.round(u.left+t*x+(x-C)/2);for(let i=0;i<y;i++){const d=Number.isFinite(n[i][t])?n[i][t]:0,l="score"===o[t],S=r+i*(N+_),b=document.createElementNS(NS_SVG,"g");if(l){const n=A[t],r=Math.max(0,Math.min(d,n)),o=Math.round(r/E*h),c=Math.round(m-u.bottom-o),l=document.createElementNS(NS_SVG,"rect");l.setAttribute("x",String(S)),l.setAttribute("y",String(c)),l.setAttribute("width",String(N)),l.setAttribute("height",String(o)),l.setAttribute("fill",a[i%a.length]),b.appendChild(l);const g=Math.round((n-r)/E*h),f=Math.round(m-u.bottom-(o+g)),x=document.createElementNS(NS_SVG,"rect");x.setAttribute("x",String(S)),x.setAttribute("y",String(f)),x.setAttribute("width",String(N)),x.setAttribute("height",String(g)),x.setAttribute("fill","#e5e7eb"),b.appendChild(x);const C=document.createElementNS(NS_SVG,"text");C.setAttribute("x",String(S+N/2)),C.setAttribute("y",String(c-4)),C.setAttribute("text-anchor","middle"),C.setAttribute("font-size","11");const y=r>.8*n&&(p||"chartSummary"===s&&("总分"===e[t]||"理科总分"===e[t]));C.setAttribute("fill",y?"#FF3333":"#333"),C.textContent=String(d),b.appendChild(C)}else{const t=c&&Number.isFinite(c[i])?c[i]:f,e=Math.round(d/t*h),n=Math.round(m-u.bottom-e),r=document.createElementNS(NS_SVG,"rect");r.setAttribute("x",String(S)),r.setAttribute("y",String(n)),r.setAttribute("width",String(N)),r.setAttribute("height",String(e)),r.setAttribute("fill",a[i%a.length]),b.appendChild(r);const o=document.createElementNS(NS_SVG,"text");o.setAttribute("x",String(S+N/2)),o.setAttribute("y",String(n-4)),o.setAttribute("text-anchor","middle"),o.setAttribute("font-size","11"),o.setAttribute("fill","#333"),o.textContent=String(d),b.appendChild(o)}v.appendChild(b)}const i=document.createElementNS(NS_SVG,"text");i.setAttribute("x",String(r+C/2)),i.setAttribute("y",String(m-u.bottom+16)),i.setAttribute("transform",`rotate(-30 ${r+C/2} ${m-u.bottom+16})`),i.setAttribute("text-anchor","end"),i.setAttribute("font-size","11"),i.setAttribute("fill","#555"),i.textContent=e[t],v.appendChild(i)}T.appendChild(v);const w=document.createElementNS(NS_SVG,"g"),V=u.top/2+20,R="chartSummary"===s,k=R?4:Math.max(1,Math.floor((l-u.left-u.right)/140)),H=R?90:140;for(let t=0;t<r.length;t++){const e=t%k,n=Math.floor(t/k),o=u.left+e*H,s=V+20*n,i=document.createElementNS(NS_SVG,"rect");i.setAttribute("x",String(o)),i.setAttribute("y",String(s)),i.setAttribute("width","14"),i.setAttribute("height","14"),i.setAttribute("fill",a[t%a.length]),w.appendChild(i);const c=document.createElementNS(NS_SVG,"text");c.setAttribute("x",String(o+20)),c.setAttribute("y",String(s+12)),c.setAttribute("font-size","12"),c.setAttribute("fill","#333"),c.textContent=r[t],w.appendChild(c)}T.appendChild(w),d.appendChild(T)}function renderChart(){const t=document.getElementById("nameSelect").value,e=(document.getElementById("examSelect").value,document.getElementById("statusBar")),n=[];namesOrder.length&&examsOrder.length||n.push("暂无可用数据，请检查数据对象。");const r=byNameExam[t]?Object.keys(byNameExam[t]):[];0===r.length&&n.push("该学生暂无任何考试记录。");const o=r,a=[...SUBJECTS],s=a.map(()=>"score"),i=o.map(e=>{const n=byNameExam[t]?.[e]||{};return a.map(t=>"number"==typeof n[t]?n[t]:0)});drawGroupedBarChart(`${t} - 所有考试 - 各科成绩`,a,i,o,s,COLOR_PALETTE,"chartScores",25);const c=["总分","理科总分","总分班排","理科班排"],d=c.map(t=>"总分班排"===t||"理科班排"===t?"rank":"score"),l=o.map(e=>{const n=byNameExam[t]?.[e]||{};return c.map(t=>"number"==typeof n[t]?n[t]:0)}),m=`${t} - 所有考试 - 总分&排名`,u=o.map(t=>{const e=records.filter(e=>e["考试"]===t).length;return e>0?e:1});drawGroupedBarChart(m,c,l,o,d,COLOR_PALETTE,"chartSummary",150,u);const S=[];for(const t of n)S.push(`<span class='warn badge'>${t}</span>`);e.innerHTML=S.join(" ")}function init(){precomputeDataBaseTotals(),buildData(),computeClassRanks(records),fillSelectOptions(),renderTable(),renderChart(),document.getElementById("nameSelect").addEventListener("change",()=>{renderTable(),renderChart()}),document.getElementById("examSelect").addEventListener("change",()=>{renderTable(),renderChart()}),document.getElementById("rotateBtn").addEventListener("click",()=>{const t=document.documentElement,e=!t.classList.contains("landscape-mode"),n=document.getElementById("rotateBtn");n.disabled=!0;try{t.classList.toggle("landscape-mode",e)}finally{n.disabled=!1,renderChart()}}),window.addEventListener("resize",()=>{renderChart()})}try{init()}catch(t){document.getElementById("statusBar").innerHTML=`<span class='warn badge'>初始化失败：${t?.message||t}</span>`}</script></body></html>