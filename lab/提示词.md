你是一位专业的前端提示词撰写专家，请根据用户的需求，撰写符合要求的前端提示词：
1. 我有一个Excel表格，其中包含了 序号、姓名、考次、语文、数学、英语、物理、化学、生物、政治、历史、地理、总分年排、理科年排
2. 表格中每个学生的考次都有多个，每个考次的成绩都不同，已知的考次有：10月考、12月考、期中考、期末考
3. 我需要一个下拉选择框，用户可以选择展示哪个“姓名”的成绩，还需要另外一个下拉选择框，用户可以选择展示哪个“考次”的成绩
4. 将Excel中的数据，生成一个JSON对象，每个学生的姓名作为JSON对象的key，每个学生的所有成绩作为JSON对象的value
5. 我需要根据这些数据生成一个表格，展示Excel中的列，并自动算出：
   1. 每个学生的总分，总分=语文+数学+英语+物理+化学+生物+政治+历史+地理，理科总分=语文+数学+英语+物理+化学+生物
   2. 每个学生的总分班排，根据总分从高到低排序，相同总分按姓名排序
   3. 每个学生的理科班排，根据理科总分从高到低排序，相同理科总分按姓名排序
6. 我需要根据这个表格，生成一个Echarts图表，echarts 的使用参考 https://echarts.apache.org/handbook/zh/get-started/
7. Echarts图表，展示每位学生的全科及排名信息，X轴为“科目”，Y轴为“排名”或“成绩”，每个科目有多个柱状图，每个柱状图展示该学生在该科目的成绩
8.  所有功能，使用纯粹 HTML、CSS、JavaScript 实现，不依赖任何前端框架, 只引入 echarts.js

---

- 角色：你是一位专业的前端研发工程师，负责实现一个成绩展示与可视化页面。
- 目标：用纯 HTML、CSS、JavaScript（仅引入 `echarts.js`）实现一个成绩展示与可视化页面，支持按“姓名”和“考次”筛选，自动计算总分与班排，并用 Echarts 展示各科成绩与排名。
- 数据来源：读取 `成绩表.csv` 文件（列顺序：序号、姓名、考次、语文、数学、英语、物理、化学、生物、政治、历史、地理、总分年排、理科年排）每列以`,`分隔
- 将`CSV`文件内容读固化到一个JavaScript变量中，并生成一个JSON对象
- JSON结构：将 CSV 转为一个对象，以“姓名”为 key，value 为该学生所有考次的成绩字典；每个考次包含各科分数及计算字段。
  - 形如：`{ "张三": { "10月考": { "语文": 120, "数学": 130, "英语": 125, "物理": 110, "化学": 108, "生物": 105, "政治": 95, "历史": 98, "地理": 100, "总分":850,  "总分年排": 1091, "理科总分": 678,"理科年排": 678 }, "期末考": { ... } }, "李四": { ... } }`
- 计算规则：
  - 总分 = 语文 + 数学 + 英语 + 物理 + 化学 + 生物 + 政治 + 历史 + 地理
  - 理科总分 = 语文 + 数学 + 英语 + 物理 + 化学 + 生物
  - 总分班排：同一“考次”内，按总分降序；总分相同按姓名升序（`localeCompare('zh-Hans')`）
  - 理科班排：同一“考次”内，按理科总分降序；理科总分相同按姓名升序
- 页面元素：
  - 请选择学生：选择“姓名”，默认值为第一个出现的姓名（如“姜人文”）
  - 请选择考次：选择“考次”，默认值为第一个出现的考次（如“10月考”）
  - 表格：展示列—序号、姓名、考次、语文、数学、英语、物理、化学、生物、政治、历史、地理、总分、总分班排、总分年排、理科总分、理科班排、理科年排；支持点击表头按该列排序（次序在 UI 上提示）
  - 图表容器：使用 Echarts 柱状图
- 数据处理要求：
  - 忽略空行与缺失列；对非法数值置为 0 并在表格中标注
  - 聚合为按“姓名”分组、按“考次”索引的 JSON；同时生成一个平铺数组用于表格与排序
- 排名计算与展示：
  - 切换到某“考次”后，重算该考次全体学生的“总分班排”和“理科班排”
- Echarts配置：
  - X轴为科目：["语文","数学","英语","物理","化学","生物","政治","历史","地理","地理","总分年排","理科年排"]
  - 展示 Y 轴为“成绩”或“排名”，如果是"总分年排","理科年排"，则展示排名，否则展示成绩
- 交互逻辑：
  - 加载数据后动态填充下拉框选项（姓名去重、考次去重，按出现顺序）
  - 任何选择更改均触发表格与图表刷新
- 约束与交付：
  - 不使用任何框架或额外库；仅通过 `<script src="https://cdn.jsdelivr.net/npm/echarts@latest/dist/echarts.min.js"></script>` 引入 Echarts
  - 所有代码为一个可直接双击打开的静态 HTML 文件，内联或单独 CSS/JS 皆可；请确保在本地文件协议下可运行
  - 代码中加入详细注释
  - 提供完善的空数据与异常处理（例如无可用考次、某学生某考次缺科目数据）
  - 保证在最新 Chrome 浏览器下表现正常，数据量为几百行时仍流畅

- 实现步骤（请按此顺序编码）：
  1. 搭建基础结构：两个下拉框、成绩/排名切换、表格容器、图表容器
  2. CSV 解析与校验：生成标准化记录数组与按姓名-考次的 JSON
  3. 计算总分与理科总分；按考次分组计算两类班排并写回记录
  4. 下拉选项填充与默认选中；绑定事件
  5. 表格渲染与列排序逻辑
  6. Echarts 图表渲染函数：根据当前选择与模式绘制系列与轴；支持窗口大小变化自适应
  7. 边界处理与提示：无数据、选项无效、重复姓名等场景的 UI 提示
  8. 代码整合与性能优化：减少重复计算、缓存分组与排名结果、避免频繁重排



将 总分、总分班排、理科总分、理科班排 也展示到图表上